<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zeno TV - Live Channels</title>

<link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet"/>
<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>

<style>
body{margin:0;background:#000;color:#fff;font-family:sans-serif;overflow:hidden;}
#player{position:absolute;top:0;left:0;width:100%;height:100vh;z-index:1;}
.overlay{position:absolute;bottom:0;left:0;width:100%;background:rgba(0,0,0,0.8);padding:20px;z-index:2;}
.channel-row{display:flex;gap:15px;overflow-x:auto;}
.channel-card{flex:0 0 180px;height:90px;background:#222;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;outline:none;border:2px solid transparent;transition:0.2s;}
.channel-card:focus{border-color:#e50914;transform:scale(1.1);background:#333;}
</style>
</head>

<body>

<video id="player" class="video-js vjs-default-skin" autoplay playsinline></video>

<div class="overlay">
<div class="channel-row" id="channelList"></div>
</div>

<script>
const m3uUrl="https://raw.githubusercontent.com/soheltanver85-a11y/Live-tv2/refs/heads/main/Live-tv2";

const player=videojs('player');

async function fetchM3U(){
  const res=await fetch(m3uUrl);
  const text=await res.text();

  // প্রথমে সব স্পেস/লাইন ব্রেক ঠিক করা
  const clean = text.replace(/ #EXTINF/g,"\n#EXTINF");
  const lines = clean.trim().split("\n");

  let channels=[];

  for(let i=0;i<lines.length;i++){
    if(lines[i].startsWith("#EXTINF")){
      const info=lines[i];
      const nextUrl = lines[i+1]?.trim();

      if(nextUrl && !nextUrl.startsWith("#")){
        const name = info.split(",")[1]?.trim();
        const logoMatch = info.match(/tvg-logo="([^"]+)"/);
        const logo = logoMatch ? logoMatch[1] : "";

        channels.push({name, url: nextUrl, logo});
      }
    }
  }
  renderChannels(channels);
}

function renderChannels(channels){
  const list = document.getElementById("channelList");
  list.innerHTML="";

  channels.forEach(ch => {
    const card = document.createElement("div");
    card.className="channel-card";
    card.tabIndex=0;
    card.innerText=ch.name;

    card.onfocus = () => {
      player.src({type:'application/x-mpegURL',src:ch.url});
      player.play();
    };

    list.appendChild(card);
  });

  // Auto focus first
  setTimeout(()=>document.querySelector(".channel-card")?.focus(),300);
}

fetchM3U();
</script>

</body>
</html>
